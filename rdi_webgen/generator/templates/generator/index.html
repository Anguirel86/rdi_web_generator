<!DOCTYPE html>
<html>
    {% load static %}
    <head>
        <title>Rando Dalton Imperial Web Generator</title>
        <!-- Bootstrap stuff  - TODO - prune these, probably don't need them all -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <link href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/css/bootstrap4-toggle.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/js/bootstrap4-toggle.min.js"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/bootstrap-select.min.js"></script>

        <script>
            function set_preset(name, blank_file) {
                // Set the preset field name to the chosen preset
                document.getElementById("{{form.preset_file.id_for_label}}").value = name;
                document.getElementById("{{form.settings_file.id_for_label}}").value = "";
            }

            function settings_file_changed() {
                const parts = document.getElementById("{{form.settings_file.id_for_label}}").value.split(/[/\\]/);
                document.getElementById("{{form.preset_file.id_for_label}}").value = parts.pop();
            }
        </script>
    </head>

    <body>
        <div class="container pt-3">
            <div class="card mb-3">
                <h4 class="card-header">Rando Dalton Imperial</h4>
                <p class="card-text p-4">
                    Rando Dalton Imperial (RDI) is an open world randomizer for Chrono Trigger.  This randomizer is heavily influenced by previous open world randomizers for Chrono Trigger, both Jets of Time and Wings of Time before it.  While those randomizers take liberties with the gameplay to provide a tight racing experience, this randomizerâ€™s goal is to preserve as much of the vanilla gameplay experience as possible.
                </p>
            </div>

            <!-- Display any errors from a previous generation attempt -->
            <div>
                <h3 style="color: red">{{error_text}}</h3>
            </div>

            <div class="card mb-3">
                <h4 class="card-header">Get started</h4>
                <div>
                    <h5 class="card-header">Select a preset or provide a custom settings file</h5>
                    <form name="gen_form" id="gen_form" action="{% url 'generator:generate' %}" target="_blank" method="post" enctype="multipart/form-data">
                        {% csrf_token %}

                        <div class="form-group pr-4">
                            <label class="form-label ml-2 pt-4" for="{{form.settings_file.id_for_label}}">Upload a custom settings (.toml) file.</label>
                            <input type="file" class="form-control mr-2 ml-2" id="{{form.settings_file.id_for_label}}" name="{{form.settings_file.name}}" onchange="settings_file_changed()"/>
                            <ul class="mt-4">
                                <li><a href="https://github.com/Pseudoarc/ctrando/tree/main/src/ctrando/settings/presets" target="_blank">Get sample settings files here</a></li>
                                <li><a href="{% url 'generator:toml_form' %}" target="_blank">Or create a custom file with our settings builder</a></li>
                            </ul>
                        </div>


                        <label class="form-label ml-2 pt-1">Or select a preset:</label>
                        <div class="border border-secondary rounded p-2 ml-2 mr-3">
                            <button class="btn btn-primary mt-1 mb-1" type="button" onclick="set_preset('samplesettings')">Sample Preset</button>
                            <button class="btn btn-primary mt-1 mb-1" type="button" onclick="set_preset('preset1')">Preset1</button>
                            <button class="btn btn-primary mt-1 mb-1" type="button" onclick="set_preset('preset2')">Preset2</button>
                        </div>
                        <div class="form-group pr-4">
                            <label class="form-label ml-2 pt-4" for="{{frm.preset_file.id_for_label}}">Chosen settings:</label>
                            <input type="textbox" class="form-control ml-2 mr-2"  id="{{form.preset_file.id_for_label}}" name="{{form.preset_file.name}}" readonly>
                        </div>

                        <button class="btn btn-primary mb-2 ml-2" type="submit">Generate Patch</button>
                    </form>
                </div>
                <div>
                    <h5 class="card-header">Play your seed</h5>
                    <p class="card-text p-4">Place the patch file in the same directory as your vanilla ROM.  Make sure they both have the same name and most emulators will automatically apply the patch when the game loads.  Give the files a unique name so that the emulator doesn't try to load save data from an old seed.</p>
                </div>

            </div>

            <!-- Links to stuff -->
            <div class="card mb-3">
                <h4 class="card-header">Resources</h4>
                <ul class="card-text p-4">
                    <li><a href="https://discord.gg/uwYhG2YrAAl">Join our Discord</a></li>
                    <li><a href="https://docs.google.com/document/d/1lrpnDAR66YIaDHZmlTunPH5PR1_WosjCUYu11101Hvs/edit?tab=t.0#heading=h.y5mkdovjdrae">Beginner's Guide</a></li>
                </ul>
            </div>
        </div>
    </body>
</html>
